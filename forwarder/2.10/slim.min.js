// egnyte-js-sdk v2.10.0 (2022-07-21) 
// license:Apache2 
// ztenerowicz@egnyte.com 
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Egnyte=a()}}(function(){var a;return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c||a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d;d="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},b.exports=d},{}],2:[function(a,b,c){function d(a){var b=!1;return function(){if(!b)return b=!0,a.apply(this,arguments)}}b.exports=d,d.proto=d(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return d(this)},configurable:!0})})},{}],3:[function(a,b,c){var d=function(a){return a.replace(/^\s+|\s+$/g,"")},e=function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.exports=function(a){if(!a)return{};for(var b={},c=d(a).split("\n"),f=0;f<c.length;f++){var g=c[f],h=g.indexOf(":"),i=d(g.slice(0,h)).toLowerCase(),j=d(g.slice(h+1));void 0===b[i]?b[i]=j:e(b[i])?b[i].push(j):b[i]=[b[i],j]}return b}},{}],4:[function(b,c,d){!function(b,d){"function"==typeof a&&a.amd?a([],d):"object"==typeof c&&c.exports?c.exports=d():b.pinkySwear=d()}(this,function(){function a(a){return"function"==typeof a}function b(a){return"object"==typeof a}function c(a){"undefined"!=typeof setImmediate?setImmediate(a):"undefined"!=typeof process&&process.nextTick?process.nextTick(a):setTimeout(a,0)}var d;return function e(f){var g,h=[],i=[],j=function(a,b){return null==g&&null!=a&&(g=a,h=b,i.length&&c(function(){for(var a=0;a<i.length;a++)i[a]()})),g};return j.then=function(j,k){var l=e(f),m=function(){function c(e){var f,g=0;try{if(e&&(b(e)||a(e))&&a(f=e.then)){if(e===l)throw new TypeError;f.call(e,function(){g++||c.apply(d,arguments)},function(a){g++||l(!1,[a])})}else l(!0,arguments)}catch(h){g++||l(!1,[h])}}try{var e=g?j:k;a(e)?c(e.apply(d,h||[])):l(g,h)}catch(f){l(!1,[f])}};return null!=g?c(m):i.push(m),l},f&&(j=f(j)),j}})},{}],5:[function(a,b,c){var d,e="undefined"!=typeof window?window.navigator.userAgent:"",f=/OS X/.test(e),g=/Opera/.test(e),h=!/like Gecko/.test(e)&&!g,i=b.exports={0:f?"<menu>":"<UNK>",1:"<mouse 1>",2:"<mouse 2>",3:"<break>",4:"<mouse 3>",5:"<mouse 4>",6:"<mouse 5>",8:"<backspace>",9:"<tab>",12:"<clear>",13:"<enter>",16:"<shift>",17:"<control>",18:"<alt>",19:"<pause>",20:"<caps-lock>",21:"<ime-hangul>",23:"<ime-junja>",24:"<ime-final>",25:"<ime-kanji>",27:"<escape>",28:"<ime-convert>",29:"<ime-nonconvert>",30:"<ime-accept>",31:"<ime-mode-change>",27:"<escape>",32:"<space>",33:"<page-up>",34:"<page-down>",35:"<end>",36:"<home>",37:"<left>",38:"<up>",39:"<right>",40:"<down>",41:"<select>",42:"<print>",43:"<execute>",44:"<snapshot>",45:"<insert>",46:"<delete>",47:"<help>",91:"<meta>",92:"<meta>",93:f?"<meta>":"<menu>",95:"<sleep>",106:"<num-*>",107:"<num-+>",108:"<num-enter>",109:"<num--\x3e",110:"<num-.>",111:"<num-/>",144:"<num-lock>",145:"<scroll-lock>",160:"<shift-left>",161:"<shift-right>",162:"<control-left>",163:"<control-right>",164:"<alt-left>",165:"<alt-right>",166:"<browser-back>",167:"<browser-forward>",168:"<browser-refresh>",169:"<browser-stop>",170:"<browser-search>",171:"<browser-favorites>",172:"<browser-home>",173:f&&h?"-":"<volume-mute>",174:"<volume-down>",175:"<volume-up>",176:"<next-track>",177:"<prev-track>",178:"<stop>",179:"<play-pause>",180:"<launch-mail>",181:"<launch-media-select>",182:"<launch-app 1>",183:"<launch-app 2>",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",223:"<meta>",224:"<meta>",226:"<alt-gr>",229:"<ime-process>",231:g?"`":"<unicode>",246:"<attention>",247:"<crsel>",248:"<exsel>",249:"<erase-eof>",250:"<play>",251:"<zoom>",252:"<no-name>",253:"<pa-1>",254:"<clear>"};for(d=58;d<65;++d)i[d]=String.fromCharCode(d);for(d=48;d<58;++d)i[d]=d-48+"";for(d=65;d<91;++d)i[d]=String.fromCharCode(d);for(d=96;d<106;++d)i[d]="<num-"+(d-96)+">";for(d=112;d<136;++d)i[d]="F"+(d-111)},{}],6:[function(a,b,c){"use strict";function d(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0}function e(a,b){function c(){4===l.readyState&&j()}function f(){var a=void 0;if(l.response?a=l.response:"text"!==l.responseType&&l.responseType||(a=l.responseText||l.responseXML),u)try{a=JSON.parse(a)}catch(b){}return a}function g(a){clearTimeout(o),a instanceof Error||(a=new Error(""+(a||"Unknown XMLHttpRequest Error"))),a.statusCode=0,b(a,k)}function j(){if(!n){var c;clearTimeout(o),c=a.useXDR&&void 0===l.status?200:1223===l.status?204:l.status;var d=k,e=null;0!==c?(d={body:f(),statusCode:c,method:q,headers:{},url:p,rawRequest:l},l.getAllResponseHeaders&&(d.headers=i(l.getAllResponseHeaders()))):e=new Error("Internal XMLHttpRequest Error"),b(e,d,d.body)}}var k={body:void 0,headers:{},statusCode:0,method:q,url:p,rawRequest:l};if("string"==typeof a&&(a={uri:a}),a=a||{},void 0===b)throw new Error("callback argument missing");b=h(b);var l=a.xhr||null;l||(l=a.cors||a.useXDR?new e.XDomainRequest:new e.XMLHttpRequest);var m,n,o,p=l.url=a.uri||a.url,q=l.method=a.method||"GET",r=a.body||a.data,s=l.headers=a.headers||{},t=!!a.sync,u=!1;if("json"in a&&(u=!0,s.accept||s.Accept||(s.Accept="application/json"),"GET"!==q&&"HEAD"!==q&&(s["content-type"]||s["Content-Type"]||(s["Content-Type"]="application/json"),r=JSON.stringify(a.json))),l.onreadystatechange=c,l.onload=j,l.onerror=g,l.onprogress=function(){},l.ontimeout=g,l.open(q,p,!t,a.username,a.password),t||(l.withCredentials=!!a.withCredentials),!t&&a.timeout>0&&(o=setTimeout(function(){n=!0,l.abort("timeout");var a=new Error("XMLHttpRequest timeout");a.code="ETIMEDOUT",g(a)},a.timeout)),l.setRequestHeader)for(m in s)s.hasOwnProperty(m)&&l.setRequestHeader(m,s[m]);else if(a.headers&&!d(a.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in a&&(l.responseType=a.responseType),"beforeSend"in a&&"function"==typeof a.beforeSend&&a.beforeSend(l),l.send(r),l}function f(){}var g=a(1),h=a(2),i=a(3);b.exports=e,e.XMLHttpRequest=g.XMLHttpRequest||f,e.XDomainRequest="withCredentials"in new e.XMLHttpRequest?e.XMLHttpRequest:g.XDomainRequest},{1:1,2:2,3:3}],7:[function(a,b,c){b.exports={handleQuota:!0,QPS:2,forwarderAddress:"app/integ/forwarder/1.4/apiForwarder.html",channelMarker:"'E",httpRequest:null,oldIEForwarder:!1}},{}],8:[function(a,b,c){var d=a(18),e=a(9),f=a(21),g=a(16),h=a(14),i=a(17),j=a(23),k=a(22),l=a(13),m=a(20);b.exports=function(b){var c=new e(b),n=new d(c,b),o=new f(n),p=new g(n),q=new h(n),r=new i(n),s=new j(n),t=new k(n),u=new m(n),v=new l(n),w={auth:c,storage:o,notes:p,link:q,events:v,search:u,perms:r,userPerms:s,user:t};if(!("withCredentials"in new window.XMLHttpRequest))if(b.acceptForwarding){var x=a(24);x(b,w)}else if(b.oldIEForwarder){var y=a(25);y(b,w)}return w.manual=n,w}},{13:13,14:14,16:16,17:17,18:18,20:20,21:21,22:22,23:23,24:24,25:25,9:9}],9:[function(a,b,c){function d(a){this.type="Bearer",this.options=a,this.options.token&&(this.token=this.options.token),this.userInfo=null,this.getUserInfo=h.bindThis(this,this.getUserInfo)}var e=/access_token=([^&]+)/,f=/error=access_denied/,g=a(28),h=a(31),i=a(29),j=a(32),k=(a(12),a(26).userinfo),l=a(26).tokenauth,m={};m._buildTokenQuery=function(a){var b=this.options.egnyteDomainURL+l+"?client_id="+this.options.key+"&mobile="+~~this.options.mobile+"&redirect_uri="+encodeURIComponent(a);return this.options.scope&&(b+="&scope="+this.options.scope),b},m._reloadForToken=function(){window.location.href=this._buildTokenQuery(window.location.href)},m._checkTokenResponse=function(a,b,c,d){var g=d||window;if(this.token)a&&a();else{this.userInfo=null;var h=e.exec(g.location.hash);h?h.length>1&&(this.token=h[1],a&&a()):f.test(g.location.href)?b&&b():c&&c()}},m.requestTokenReload=function(a,b){this._checkTokenResponse(a,b,h.bindThis(this,this._reloadForToken))},m.requestTokenIframe=function(a,b,c,d){if(this.token)b();else{var e=this,f=window.location;d=d?f.protocol+"//"+f.host+d:f.href;var g=e._buildTokenQuery(d),h=i.createFrame(g,!0);h.onload=function(){try{var d=h.contentWindow.location,f={location:{hash:""+d.hash,href:""+d.href}};e._checkTokenResponse(function(){h.src="",a.removeChild(h),b()},function(){h.src="",a.removeChild(h),c()},null,f)}catch(g){}},a.appendChild(h)}},m._postTokenUp=function(){var a=this;if(!this.token&&window.name===this.options.channelMarker){var b={marker:this.options.channelMarker,sourceOrigin:this.options.egnyteDomainURL};this._checkTokenResponse(function(){j.sendMessage(window.opener,b,"token",a.token)},function(){j.sendMessage(window.opener,b,"denied","")})}},m.requestTokenPopup=function(a,b,c){var d=this;if(this.token)a();else{var e=this._buildTokenQuery(c),f=window.open(e);f.name=this.options.channelMarker;var g=j.createMessageHandler(null,this.options.channelMarker,function(c){h.destroy(),f.close(),"token"===c.action&&(d.token=c.data,a&&a()),"denied"===c.action&&b&&b()}),h=i.addListener(window,"message",g)}},m.requestTokenByPassword=function(a,b){var c=this;return this.requestEngine.promiseRequest({method:"POST",url:this.options.egnyteDomainURL+l+"",headers:{"content-type":"application/x-www-form-urlencoded"},body:["client_id="+this.options.key,"grant_type=password","username="+encodeURIComponent(a),"password="+encodeURIComponent(b)].join("&")},null,!0).then(function(a){return c.token=a.body.access_token,c.token})},m.authorizeXHR=function(a){a.setRequestHeader("Authorization","Bearer "+this.token)},m.getHeaders=function(){return{Authorization:"Bearer "+this.token}},m.isAuthorized=function(){return!!this.token},m.getToken=function(){return this.token},m.setToken=function(a){this.token=a},m.dropToken=function(a){this.token=null},m.addRequestEngine=function(a){this.requestEngine=a},m.getUserInfo=function(){var a=this;return a.userInfo||!this.requestEngine?g(!0).then(function(){return a.userInfo}):this.requestEngine.promiseRequest({method:"GET",url:this.requestEngine.getEndpoint()+k}).then(function(b){return a.userInfo=b.body,b.body})},d.prototype=m,b.exports=d},{12:12,26:26,28:28,29:29,31:31,32:32}],10:[function(a,b,c){function d(a,b,c,d,e){c=g.encodeNameSafe(c)||"";var f={headers:d,method:"POST",url:a.getEndpoint()+h.fschunked+g.encodeURIPath(c),body:e};return a.promiseRequest(b(f))}function e(a,b,c){this.storage=a,this.path=b,this.mime=c,this.num=1,this.successful=1,this.chunksPromised=[]}var f=a(28),g=a(31),h=a(26),i={};i.setId=function(a){this.id=a},i.sendChunk=function(a,b,c){var e=this,f=this.storage.requestEngine,g=this.storage.getDecorator();b?e.num=b:b=++e.num;var h={"x-egnyte-upload-id":e.id,"x-egnyte-chunk-num":e.num},i=d(f,g,e.path,h,a).then(function(a){return c&&c(a.response.headers["x-egnyte-chunk-sha512-checksum"]),e.successful++,a});return e.chunksPromised.push(i),i},i.sendLastChunk=function(a,b){var c=this,e=this.storage.requestEngine,g=this.storage.getDecorator(),h={"x-egnyte-upload-id":c.id,"x-egnyte-last-chunk":!0,"x-egnyte-chunk-num":c.num+1};return c.mime&&(h["content-type"]=c.mime),f.allSettled(this.chunksPromised).then(function(){if(c.num===c.successful)return d(e,g,c.path,h,a).then(function(a){return b&&b(a.response.headers["x-egnyte-chunk-sha512-checksum"]),{id:a.response.headers.etag,path:c.path}});throw new Error("Tried to commit a file with missing chunks (some uploads failed)")})},e.prototype=i,c.startChunkedUpload=function(a,b,c,g){var h=this.requestEngine,i=this.getDecorator(),j=new e(this,a,c);return f(!0).then(function(){var e={};return c&&(e["content-type"]=c),d(h,i,a,e,b)}).then(function(a){return g&&g(a.response.headers["x-egnyte-chunk-sha512-checksum"]),j.setId(a.response.headers["x-egnyte-upload-id"]),j})}},{26:26,28:28,31:31}],11:[function(a,b,c){function d(){var a=this;return function(b){return e.each(a._decorators,function(c,d){void 0!==a._decorations[d]&&(b=c(b,a._decorations[d]))}),b}}var e=a(31),f={impersonate:function(a,b){return a.headers||(a.headers={}),b.username&&(a.headers["X-Egnyte-Act-As"]=b.username),b.email&&(a.headers["X-Egnyte-Act-As-Email"]=b.email),a},customizeRequest:function(a,b){return b(a)},requestId:function(a,b){return a.headers||(a.headers={}),b&&(a.headers["X-Egnyte-Request-Id"]=b),a}};b.exports={install:function(a){function b(a){e.each(a._decorators,function(c,f){a[f]=function(a){var c=function(){};c.prototype=this;var g=new c;return g.getDecorator=d,g._decorations=e.extend({},this._decorations),g._decorations[f]=a||null,b(g),g}})}a._decorators=e.extend({},f),b(a),a.addDecorator=function(a,c){this._decorators[a]=c,b(this)},a.getDecorator=function(){return e.id}}}},{31:31}],12:[function(a,b,c){function d(a){var b;for(var c in a){if(f[c])return a[c];if("object"==typeof a[c]&&(b=d(a[c])))return b}}function e(a,b){var c;if("string"==typeof a){try{c=d(JSON.parse(a)),c||(c=a)}catch(e){c=a?a.replace(g,"$1"):"Unknown error"}404===b&&a.length>300&&(c="Not found")}else c=d(a);return c}var f={msg:1,message:1,errorMessage:1},g=/^\s*<h1>([^<]*)<\/h1>\s*$/gi;b.exports=function(a){var b,c;return a.response?(c=~~a.response.statusCode,b=a.error,b.statusCode=c,b.message=""+e(a.body||a.error.message,c),b.response=a.response,b.body=a.body):(b=a.error,b.statusCode=0),b}},{}],13:[function(a,b,c){function d(a){this.requestEngine=a,j.install(this),this.addDecorator("filter",e),this.addDecorator("notMy",f)}function e(a,b){return a.params||(a.params={}),b.folder&&(a.params.folder=b.folder),b.type&&(b.type.join?a.params.type=b.type.join("|"):a.params.type=b.type),a}function f(a,b){return a.params||(a.params={}),a.params.suppress=b||"app",a}var g=a(28),h=a(31),i=a(30),j=a(11),k=a(26).events,l=a(26).eventscursor,m=20;d.prototype={getCursor:function(){var a=this.requestEngine;return a.promiseRequest({method:"GET",url:a.getEndpoint()+l}).then(function(a){return a.body.latest_event_id})},getUpdate:function(a){var b=this.requestEngine,c=this.getDecorator();return g(!0).then(function(){if(!(a.start>=0))throw new Error("'start' option is required");var d=a.count||m;return b.promiseRequest(c({method:"GET",url:b.getEndpoint()+k,params:{id:a.start,count:d}}))}).then(function(b){return b.body&&a.emit&&h.each(b.body.events,function(b){setTimeout(function(){a.emit(b)},0)}),b})},listen:function(a){var b=this;return g(!0).then(function(){return isNaN(a.start)?b.getCursor():a.start}).then(function(c){var d=c;return a.current&&a.current(d),i(Math.max(a.interval||3e4,2e3),function(c){var e=a.count||m;return b.getUpdate({count:e,emit:a.emit,start:d}).then(function(b){b.body&&(d=b.body.latest_id,a.current&&a.current(d),b.body.events.length>=e&&c.repeat()),a.heartbeat&&a.heartbeat(b.body)})},a.error)})}},b.exports=d},{11:11,26:26,28:28,30:30,31:31}],14:[function(a,b,c){function d(a){this.requestEngine=a,g.install(this)}var e=a(28),f=a(31),g=a(11),h=a(26).links,i={};i.createLink=function(a){var b=this.requestEngine,c=this.getDecorator(),d={path:null,type:"file",accessibility:"domain"};return e(!0).then(function(){if(a=f.extend(d,a),a.path=f.encodeNameSafe(a.path),!a.path)throw new Error("Path attribute missing or incorrect");return b.promiseRequest(c({method:"POST",url:b.getEndpoint()+h,json:a}))}).then(function(a){return a.body})},i.removeLink=function(a){var b=this.requestEngine,c=this.getDecorator();return b.promiseRequest(c({method:"DELETE",url:b.getEndpoint()+h+"/"+a})).then(function(a){return a.response.statusCode})},i.listLink=function(a){var b=this.requestEngine,c=this.getDecorator();return b.promiseRequest(c({method:"GET",url:b.getEndpoint()+h+"/"+a})).then(function(a){return a.body})},i.listLinks=function(a){var b=this.requestEngine,c=this.getDecorator();return e(!0).then(function(){return a.path=a.path&&f.encodeNameSafe(a.path),b.promiseRequest(c({method:"get",url:b.getEndpoint()+h,params:a}))}).then(function(a){return a.body})},i.findOne=function(a){var b=this;return b.listLinks(a).then(function(a){return a.ids&&a.ids.length>0?b.listLink(a.ids[0]):null})},d.prototype=i,b.exports=d},{11:11,26:26,28:28,31:31}],15:[function(a,b,c){var d=a(28),e=a(31),f=a(26).fsmeta;c.lock=function(a,b,c){var g=this.requestEngine,h=this.getDecorator();return d(!0).then(function(){a=e.encodeNameSafe(a);var d={action:"lock"};"object"==typeof b&&null!=b?d=Object.assign(d,b):(b&&(d.lock_token=b),c&&(d.lock_timeout=c));var i={method:"POST",url:g.getEndpoint()+f+e.encodeURIPath(a),json:d};return g.promiseRequest(h(i))}).then(function(b){return b.body.path=a,b.body})},c.unlock=function(a,b){var c=this.requestEngine,g=this.getDecorator();return d(!0).then(function(){a=e.encodeNameSafe(a);var d={action:"unlock",lock_token:b},h={method:"POST",url:c.getEndpoint()+f+e.encodeURIPath(a),json:d};return c.promiseRequest(g(h))}).then(function(b){return{path:a}})}},{26:26,28:28,31:31}],16:[function(a,b,c){function d(a){this.requestEngine=a,g.install(this)}var e=a(28),f=a(31),g=a(11),h=a(26).notes,i={};i.path=function(a){a=f.encodeNameSafe(a);var b=this;return{addNote:function(c){var d=b.requestEngine,f=b.getDecorator();return e(!0).then(function(){var b={method:"POST",url:d.getEndpoint()+h,json:{path:a,body:c}};return d.promiseRequest(f(b))}).then(function(a){return{id:a.body.id}})},listNotes:function(c){var d=b.requestEngine,g=b.getDecorator();return e(!0).then(function(){a=f.encodeNameSafe(a);var b={method:"GET",url:d.getEndpoint()+h};return b.params=f.extend({file:f.encodeURIPath(a)},c),d.promiseRequest(g(b)).then(function(a){return a.body})})}}},i.getNote=function(a){var b=this.requestEngine,c=this.getDecorator();return e(!0).then(function(){var d={method:"GET",url:b.getEndpoint()+h+"/"+f.encodeURIPath(a)};return b.promiseRequest(c(d)).then(function(a){return a.body})})},i.removeNote=function(a){var b=this.requestEngine,c=this.getDecorator();return e(!0).then(function(){var d={method:"DELETE",url:b.getEndpoint()+h+"/"+f.encodeURIPath(a)};return b.promiseRequest(c(d))})},d.prototype=i,b.exports=d},{11:11,26:26,28:28,31:31}],17:[function(a,b,c){function d(a){this.requestEngine=a,h.install(this),this.addDecorator("users",e("users")),this.addDecorator("groups",e("groups"))}function e(a){return function(b,c){switch(b.method){case"GET":b.params||(b.params={}),b.params[a]=c.join("|");break;case"POST":b.json[a]=c}return b}}var f=a(28),g=a(31),h=a(11),i=a(19),j=a(26).perms,k={};k.disallow=function(a){return k.allow.call(this,a,"None")},k.allowView=function(a){return k.allow.call(this,a,"Viewer")},k.allowEdit=function(a){return k.allow.call(this,a,"Editor")},k.allowFullAccess=function(a){return k.allow.call(this,a,"Full")},k.allowOwnership=function(a){return k.allow.call(this,a,"Owner")},k.allow=function(a,b){var c=this.requestEngine,d=this.getDecorator();return f(!0).then(function(){a=g.encodeNameSafe(a)||"";var e={method:"POST",url:c.getEndpoint()+j+g.encodeURIPath(a),json:{permission:b}};return c.promiseRequest(d(e))}).then(function(a){return a.response})},k.getPerms=function(a){var b=this.requestEngine,c=this.getDecorator();return f(!0).then(function(){a=g.encodeNameSafe(a)||"";var d={method:"GET",url:b.getEndpoint()+j+g.encodeURIPath(a)};return b.promiseRequest(c(d))}).then(function(a){return a.body})},d.prototype=i(k,{pathPrefix:"/folder"}),delete d.prototype.fileId,b.exports=d},{11:11,19:19,26:26,28:28,31:31}],18:[function(a,b,c){function d(a,b){this.auth=a,this.options=b,this.requestHandler=b.httpRequest?b.httpRequest:k,this.quota={startOfTheSecond:0,calls:0,retrying:0},this.queue=[],this.queueHandler=i.bindThis(this,f),a.addRequestEngine(this)}function e(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.length?"?"+b.join("&"):""}function f(){if(this.queue.length){var a=g(this.quota,this.options.QPS);if(0===a){this.queue.shift()(),this.quota.calls++}this.quota.to=setTimeout(this.queueHandler,a)}}function g(a,b){var c=+new Date,d=c-a.startOfTheSecond;return a.retrying?(a.startOfTheSecond=c+a.retrying,a.retrying+1):d>1002?(a.startOfTheSecond=c,a.calls=0,0):a.calls<b?0:1003-d}var h=a(28),i=a(31),j=(a(29),a(32),a(12)),k=a(6),l={Promise:h};l.getEndpoint=function(){return this.options.egnyteDomainURL+"/pubapi"},l.promise=function(a){return h(a)},l.sendRequest=function(a,b,c,d){var f=this;a=i.extend({},f.options.requestDefaults,a);var g=i.extend({},a);if(this.auth.isAuthorized()||c){if(a.url+=e(a.params),a.headers=a.headers||{},c||(a.headers.Authorization=this.auth.type+" "+this.auth.getToken()),b){var h,j=function(){f.sendRequest(g,f.retryHandler(b,j,h,d))};return f.timerStart&&(h=f.timerStart(g.method,g.url||g.uri)),f.requestHandler(a,f.retryHandler(b,j,h,d))}return f.requestHandler(a)}b.call(this,new Error("Not authorized"),{statusCode:0},null)},l.retryHandler=function(a,b,c,d){var e=this;return function(f,g,h){!f&&g.statusCode>=400&&g.statusCode<600&&(f=new Error(h));try{h=JSON.parse(h)}catch(k){}if(g){var i=g.headers["retry-after"],j=g.headers["x-mashery-error-code"];i="array"==typeof i?i[0]:i,j="array"==typeof j?j[0]:j}g&&e.options.handleQuota&&403===g.statusCode&&i&&!d?("ERR_403_DEVELOPER_OVER_QPS"===j&&(console&&console.warn("developer over QPS, retrying"),e.quota.retrying=1e3*~~i,setTimeout(function(){e.quota.retrying=0,b()},e.quota.retrying)),"ERR_403_DEVELOPER_OVER_RATE"===j&&(f.RATE=!0,a.call(this,f,g,h))):(g&&e.options.onInvalidToken&&(401===g.statusCode||403===g.statusCode&&"ERR_403_DEVELOPER_INACTIVE"===j)&&(e.auth.dropToken(),e.options.onInvalidToken()),e.timerEnd&&e.timerEnd(c,g.statusCode),a.call(this,f,g,h))}},l.retrieveStreamFromRequest=function(a){var b=h.defer(),c=this,d=function(){try{var d=c.sendRequest(a);b.resolve(d)}catch(e){b.reject(j({error:e}))}};return this.options.handleQuota?(this.queue.push(d),clearTimeout(this.quota.to),this.queueHandler()):d(),b.promise},l.promiseRequest=function(a,b,c,d){var e=h.defer(),f=this,g=function(){try{var g=f.sendRequest(a,function(a,b,c){a?e.reject(j({error:a,response:b,body:c})):e.resolve({response:b,body:c})},c,d);b&&b(g)}catch(h){e.reject(j({error:h}))}};return this.options.handleQuota?(this.queue.push(g),clearTimeout(this.quota.to),this.queueHandler()):g(),e.promise},l.setupTiming=function(a,b){this.timerStart=a,this.timerEnd=b},d.prototype=l,b.exports=d},{12:12,28:28,29:29,31:31,32:32,6:6}],19:[function(a,b,c){function d(a,b){return(a?"/ids/folder/":"/ids/file/")+b}function e(a,b,c){return Function.prototype.bind?a.bind(b,c):function(d,e){return a.call(b,c,d,e)}}function f(a,b,c){var d={};return g.each(c,function(c,f){d[f]=e(c,a,b)}),d}var g=a(31);b.exports=function(a,b){return{fileId:function(b){return f(this,d(!1,b),a)},folderId:function(b){return f(this,d(!0,b),a)},path:function(c){return b&&b.pathPrefix&&(c=b.pathPrefix+c),f(this,c,a)},internals:a}}},{31:31}],20:[function(a,b,c){function d(a){this.requestEngine=a,this.count=10,f.install(this)}var e=a(28),f=(a(31),a(11)),g=a(26).search,h={};h.itemsPerPage=function(a){this.count=a||10},h.query=function(a,b){var c=this,d=c.requestEngine,f=c.getDecorator();return e(!0).then(function(){var e=["query="+encodeURIComponent(a),"offset="+~~b*c.count,"count="+c.count],h="?"+e.join("&"),i={method:"GET",url:d.getEndpoint()+g+h};return d.promiseRequest(f(i))}).then(function(a){return a.body})},h.getResults=function(a){var b=this;return b.query(a).then(function(c){return{page:function(c){return b.query(a,c).then(function(a){return a.results})},totalPages:Math.round(c.total_count/b.count),sample:c.results,totalCount:c.total_count}})},d.prototype=h,b.exports=d},{11:11,26:26,28:28,31:31}],21:[function(a,b,c){function d(a){this.requestEngine=a,i.install(this)}function e(a,b,c,d,e){return g(!0).then(function(){if(!d)throw new Error("Cannot move to empty path");c=h.encodeNameSafe(c),d=h.encodeNameSafe(d);var f={method:"POST",url:a.getEndpoint()+m.fsmeta+h.encodeURIPath(c),json:{action:e,destination:d}};return a.promiseRequest(b(f))}).then(function(a){if(200==a.response.statusCode)return{oldPath:c,path:d}})}function f(a,b,c,d){return g(!0).then(function(){c=h.encodeNameSafe(c)||"";var e={method:"DELETE",url:a.getEndpoint()+m.fsmeta+h.encodeURIPath(c)};return d&&(e.params={entry_id:d}),a.promiseRequest(b(e))}).then(function(a){return a.response.statusCode})}var g=a(28),h=a(31),i=a(11),j=(a(16),a(15)),k=a(10),l=a(19),m=a(26),n={};n.exists=function(a){var b=this.requestEngine,c=this.getDecorator();return g(!0).then(function(){a=h.encodeNameSafe(a);var d={method:"GET",url:b.getEndpoint()+m.fsmeta+h.encodeURIPath(a)};return b.promiseRequest(c(d))}).then(function(a){return 200==a.response.statusCode},function(a){if(a.response&&404==a.response.statusCode)return!1;throw a})},n.get=function(a,b){var c=this.requestEngine,d=this.getDecorator();return g(!0).then(function(){a=h.encodeNameSafe(a);var e={method:"GET",url:c.getEndpoint()+m.fsmeta+h.encodeURIPath(a)};return b&&(e.params={entry_id:b}),c.promiseRequest(d(e))}).then(function(a){return a.body})},n.parents=function(a){var b=this.requestEngine,c=this.getDecorator();return g(!0).then(function(){a=h.encodeNameSafe(a);var d={method:"GET",url:b.getEndpoint()+m.fsmeta+h.encodeURIPath(a)+"/parents"};return b.promiseRequest(c(d))}).then(function(a){return a.body})},n.download=function(a,b,c){var d=this.requestEngine,e=this.getDecorator();return g(!0).then(function(){a=h.encodeNameSafe(a);var f={method:"GET",url:d.getEndpoint()+m.fscontent+h.encodeURIPath(a)};return b&&(f.params={entry_id:b}),c&&(f.responseType="arraybuffer"),d.promiseRequest(e(f))}).then(function(a){return a.response})},n.createFolder=function(a){var b=this.requestEngine,c=this.getDecorator();return g(!0).then(function(){a=h.encodeNameSafe(a);var d={method:"POST",url:b.getEndpoint()+m.fsmeta+h.encodeURIPath(a),json:{action:"add_folder"}};return b.promiseRequest(c(d))}).then(function(b){if(201==b.response.statusCode)return{path:a}})},n.move=n.rename=function(a,b){return e(this.requestEngine,this.getDecorator(),a,b,"move")},n.copy=function(a,b){return e(this.requestEngine,this.getDecorator(),a,b,"copy")},n.storeFile=function(a,b,c){var d=this.requestEngine,e=this.getDecorator();return g(!0).then(function(){var f=b;a=h.encodeNameSafe(a)||"";var g={method:"POST",url:d.getEndpoint()+m.fscontent+h.encodeURIPath(a),body:f};return g.headers={},c&&(g.headers["Content-Type"]=c),d.promiseRequest(e(g))}).then(function(b){return{id:b.response.headers.etag,group_id:b.body.group_id,path:a}})},n.removeFileVersion=function(a,b){var c=this.requestEngine,d=this.getDecorator();return g(!0).then(function(){if(!b)throw new Error("Version ID (second argument) is missing");return f(c,d,a,b)})},n.remove=function(a,b){var c=this.getDecorator();return f(this.requestEngine,c,a,b)},n=h.extend(n,j),n=h.extend(n,k),d.prototype=l(n),b.exports=d},{10:10,11:11,15:15,16:16,19:19,26:26,28:28,31:31}],22:[function(a,b,c){function d(a){this.requestEngine=a,f.install(this)}var e=a(28),f=a(11),g=a(26).users,h={};h.getById=function(a){var b=this.requestEngine,c=this.getDecorator();return e(!0).then(function(){var d={method:"GET",url:b.getEndpoint()+g+a};return b.promiseRequest(c(d))}).then(function(a){return a.body})},h.getByName=function(a){var b=this.requestEngine,c=this.getDecorator();return e(!0).then(function(){var d={method:"GET",url:b.getEndpoint()+g,params:{filter:'userName eq "'+a+'"'}};return b.promiseRequest(c(d))}).then(function(a){if(a.body.resources&&a.body.resources[0])return a.body.resources[0];var b=Error("User not found");throw b.statusCode=404,b})},d.prototype=h,b.exports=d},{11:11,26:26,28:28}],23:[function(a,b,c){function d(a){this.requestEngine=a,g.install(this),this.addDecorator("path",e("folder")),this.addDecorator("folderId",e("folder_id"))}function e(a){return function(b,c){return b.params||(b.params={}),b.params[a]=c,b}}var f=a(28),g=a(11),h=a(26).perms,i={};i.get=function(a){var b=this.requestEngine,c=this.getDecorator();return f(!0).then(function(){var d={method:"GET",url:b.getEndpoint()+h+"/user"+(a?"/"+a:"")};return b.promiseRequest(c(d))}).then(function(a){return a.body})},d.prototype=i,b.exports=d},{11:11,26:26,28:28}],24:[function(a,b,c){function d(a){var b={};for(var c in a)"function"!=typeof a[c]&&"headers"!==c&&(b[c]=a[c]);return b}function e(a,b){function c(a){if(a.action&&"call"===a.action){var c=a.data;b[c.ns]&&b[c.ns][c.name]?(b.auth.setToken(c.token),b[c.ns][c.name].apply(b[c.ns],c.args).then(function(a){a instanceof XMLHttpRequest&&(a=d(a)),g.sendMessage(window.parent,e,"result",{status:!0,resolution:a,uid:c.uid})},function(a){g.sendMessage(window.parent,e,"result",{status:!1,resolution:a,uid:c.uid})})):g.sendMessage(window.parent,e,"nomethod",{uid:c.uid})}}var e;e={marker:a.channelMarker,sourceOrigin:a.egnyteDomainURL},e.handler=g.createMessageHandler(null,e.marker,c),e._evListener=f.addListener(window,"message",e.handler)}var f=(a(31),a(29)),g=a(32);b.exports=e},{29:29,31:31,32:32}],25:[function(a,b,c){function d(a){var b=a.data;a.action&&a.data&&n[b.uid]&&("result"===a.action&&(n[b.uid](b.status,b.resolution),n[b.uid]=null),"nomethod"===a.action&&(n[b.uid]=null))}function e(){return""+~~(9999999*Math.random())+~~(9999999*Math.random())}function f(a,b,c,d,f,g){var h=e();n[h]=g,m.sendMessage(a.iframe.contentWindow,a,"call",{ns:b,name:c,args:f,token:d,uid:h},o)}function g(a,b,c,d){return function(){var e=Array.prototype.slice.call(arguments,0),g=j.defer();return c.ready.promise.then(function(){f(c,a,b,d(),e,function(a,b){a?g.resolve(b):g.reject(b)})}),g.promise}}function h(a,b){var c=function(c,d){a[c][d]=g(c,d,b,function(){return a.auth.getToken()})};k.each(a,function(a,b){if("auth"!==b)for(var d in a)c(b,d)}),c("auth","getUserInfo");var d=a.destroy;return a.destroy=function(){if(b._evListener.destroy(),b.iframe.parentNode.removeChild(b.iframe),d)return d.apply(a,arguments)},a}function i(a,b){o=a.egnyteDomainURL;var c,e;e={marker:a.channelMarker,sourceOrigin:a.egnyteDomainURL,ready:j.defer()},e.handler=m.createMessageHandler(e.sourceOrigin,e.marker,d),e._evListener=l.addListener(window,"message",e.handler),c=l.createFrame(a.egnyteDomainURL+"/"+a.forwarderAddress),c.style.display="none";var f=function(){setTimeout(function(){e.ready.resolve()},50)};return c.addEventListener?c.addEventListener("load",f,!1):c.attachEvent&&c.attachEvent("onload",f),(document.body||document.getElementsByTagName("body")[0]).appendChild(c),e.iframe=c,h(b,e)}var j=a(28),k=a(31),l=a(29),m=a(32),n={},o="";b.exports=i},{28:28,29:29,31:31,32:32}],26:[function(a,b,c){b.exports={fsmeta:"/v1/fs",fscontent:"/v1/fs-content",fschunked:"/v1/fs-content-chunked",notes:"/v1/notes",links:"/v1/links",perms:"/v1/perms",userinfo:"/v1/userinfo",users:"/v2/users/",events:"/v1/events",search:"/v1/search",eventscursor:"/v1/events/cursor",tokenauth:"/puboauth/token"}},{}],27:[function(a,b,c){var d=a(28),e=a(31),f=a(29),g=a(32),h=a(11),i=a(26),j={};b.exports={define:function(a,b){if(j[a])throw new Error("Plugin conflict. "+a+" already exists");j[a]=b},install:function(a){e.each(j,function(b,c){b(a,{API:a.API,ENDPOINTS:i,promises:d,decorators:h,reusables:{helpers:e,dom:f,messages:g}})})}}},{11:11,26:26,28:28,29:29,31:31,32:32}],28:[function(a,b,c){function d(a,b){f.each(a,function(a,c){a.then(function(a){b(c,{state:"fulfilled",value:a})},function(a){b(c,{state:"rejected",reason:a})})})}var e=a(4),f=a(31),g=function(a){return a.fail=function(b){return a.then(0,b)},a},h=function(a){var b=e(g);return b(!0,[a]),b};h.defer=function(){var a=e(g);return{promise:a,resolve:function(b){a(!0,[b])},reject:function(b){a(!1,[b])}}},h.all=function(a){var b=h.defer(),c=[],e=a.length;return d(a,function(a,d){e&&("rejected"===d.state?(e=0,b.reject(d.reason)):(c[a]=d,0==--e&&b.resolve(c)))}),b.promise},h.allSettled=function(a){var b=h.defer(),c=[],e=a.length;return d(a,function(a,d){c[a]=d,
0==--e&&b.resolve(c)}),b.promise},b.exports=h},{31:31,4:4}],29:[function(a,b,c){function d(a,b,c){var d;return a.addEventListener?(d=c,a.addEventListener(b,c,!1)):(d=function(a){a=a||window.event,a.target||(a.target=a.srcElement);var b=c.call(this,a);return!1===b&&(a.cancelBubble=!0),b},a.attachEvent("on"+b,d)),{destroy:function(){e(a,b,d)}}}function e(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent(b,c)}var f=a(5);b.exports={addListener:d,onKeys:function(a,b,c){return d(a,"keyup",function(a){return a.target.tagName&&"input"!==a.target.tagName.toLowerCase()&&a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),(!0===c||c())&&(b[f[a.keyCode]]?b[f[a.keyCode]]():b.other&&b.other()),!1})},createFrame:function(a,b){var c=document.createElement("iframe");return b||c.setAttribute("scrolling","no"),c.style.width="100%",c.style.height="100%",c.style.minWidth="400px",c.style.minHeight="400px",c.style.border="1px solid #dbdbdb",c.src=a,c}}},{5:5}],30:[function(a,b,c){var d=a(28);b.exports=function(a,b,c){var e,f=!1,g=function(){clearTimeout(e),e=setTimeout(h,1)},h=function(){var i=e;d({interval:a,repeat:g}).then(b).fail(function(a){if(c)return c(a);console&&console.error("Error in scheduled function",a)}).then(function(){f||i!==e||(e=setTimeout(h,a))})};return h(),{stop:function(){f=!0,clearTimeout(e)},forceRun:function(){return f=!1,g()}}}},{28:28}],31:[function(a,b,c){function d(a,b){if(a)if(a.length===+a.length)for(var c=0;c<a.length;c++)b.call(null,a[c],c,a);else for(var c in a)a.hasOwnProperty(c)&&b.call(null,a[c],c,a)}function e(a,b){var c=!1;return d(a,function(a){a===b&&(c=!0)}),c}function f(a){return a.replace(/\/*$/,"")}function g(a){return a.replace(/\/*$/,"")||"/"}function h(a,b){var c;return function(){clearTimeout(c),c=setTimeout(a,b)}}var i=/[":<>|?*\\]/;b.exports={extend:function(a){var b,c;for(b=1;b<arguments.length;b++)if(arguments[b])for(c in arguments[b])arguments[b].hasOwnProperty(c)&&void 0!==arguments[b][c]&&(a[c]=arguments[b][c]);return a},noop:function(){},id:function(a){return a},bindThis:function(a,b){return function(){return b.apply(a,arguments)}},debounce:h,contains:e,each:d,normalizeURL:f,normalizePath:g,httpsURL:function(a){return"https://"+f(a).replace(/^https?:\/\//,"")},encodeNameSafe:function(a){if(!a)throw new Error("No name given");if(i.test(a))throw new Error("Disallowed characters in path");return a=a.replace(/^\/\//,"/")},encodeURIPath:function(a){return encodeURI(a).replace(/#/g,"%23")}}},{}],32:[function(a,b,c){function d(a,b,c){return function(d){if(!a||f.normalizeURL(d.origin)===f.normalizeURL(a)){var e=d.data;if("string"==typeof e&&e.substr(0,b.length)===b){try{e=JSON.parse(e.substring(b.length))}catch(g){}e&&c(e)}}}}function e(a,b,c,d,e){var f,g="*";if("string"!=typeof c)throw new TypeError("only string is acceptable as action");if(e)g=e;else try{(a.location.origin||a.location.protocol)&&(g=a.location.origin||a.location.protocol+"//"+a.location.hostname+(a.location.port?":"+a.location.port:""))}catch(h){}f=JSON.stringify({action:c,data:d}),f=f.replace(/(\r\n|\n|\r)/gm,""),a.postMessage(b.marker+f,g)}var f=a(31);b.exports={sendMessage:e,createMessageHandler:d}},{31:31}],33:[function(a,b,c){var d=a(31),e=a(27),f=a(7);b.exports={init:function(b,c){var g=d.extend({},f,c);g.egnyteDomainURL=b?d.normalizeURL(b):null;var h={domain:g.egnyteDomainURL,setDomain:function(a){this.domain=g.egnyteDomainURL=d.normalizeURL(a)},API:a(8)(g)};return e.install(h),h},plugin:e.define}},{27:27,31:31,7:7,8:8}]},{},[33])(33)});